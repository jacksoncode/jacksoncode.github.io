<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <p class="x">æ›´å¤šè¯¾ç¨‹è¯·åŠ QQç¾¤170701297</p>
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                08è®²æ¡ˆä¾‹ç¯‡ï¼šç³»ç»Ÿä¸­å‡ºç°å¤§é‡ä¸å¯ä¸­æ–­è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹æ€ä¹ˆåŠï¼ˆä¸‹ï¼‰
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/c3/a4/c3fc6fc5daceb549e55f419514ad43a4.jpg">


                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ç»™ä½ è®²äº†Linuxè¿›ç¨‹çŠ¶æ€çš„å«ä¹‰ï¼Œä»¥åŠä¸å¯ä¸­æ–­è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹äº§ç”Ÿçš„åŸå› ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•å¤ä¹ ä¸‹ã€‚</p><p>ä½¿ç”¨ ps æˆ–è€… top å¯ä»¥æŸ¥çœ‹è¿›ç¨‹çš„çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€åŒ…æ‹¬è¿è¡Œã€ç©ºé—²ã€ä¸å¯ä¸­æ–­ç¡çœ ã€å¯ä¸­æ–­ç¡çœ ã€åƒµå°¸ä»¥åŠæš‚åœç­‰ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹å­¦ä¹ äº†ä¸å¯ä¸­æ–­çŠ¶æ€å’Œåƒµå°¸è¿›ç¨‹ï¼š</p><ul>
<li>
<p>ä¸å¯ä¸­æ–­çŠ¶æ€ï¼Œä¸€èˆ¬è¡¨ç¤ºè¿›ç¨‹æ­£åœ¨è·Ÿç¡¬ä»¶äº¤äº’ï¼Œä¸ºäº†ä¿æŠ¤è¿›ç¨‹æ•°æ®ä¸ç¡¬ä»¶ä¸€è‡´ï¼Œç³»ç»Ÿä¸å…è®¸å…¶ä»–è¿›ç¨‹æˆ–ä¸­æ–­æ‰“æ–­è¯¥è¿›ç¨‹ã€‚</p>
</li>
<li>
<p>åƒµå°¸è¿›ç¨‹è¡¨ç¤ºè¿›ç¨‹å·²ç»é€€å‡ºï¼Œä½†å®ƒçš„çˆ¶è¿›ç¨‹æ²¡æœ‰å›æ”¶è¯¥è¿›ç¨‹æ‰€å ç”¨çš„èµ„æºã€‚</p>
</li>
</ul><p>ä¸Šä¸€èŠ‚çš„æœ€åï¼Œæˆ‘ç”¨ä¸€ä¸ªæ¡ˆä¾‹å±•ç¤ºäº†å¤„äºè¿™ä¸¤ç§çŠ¶æ€çš„è¿›ç¨‹ã€‚é€šè¿‡åˆ†æ top å‘½ä»¤çš„è¾“å‡ºï¼Œæˆ‘ä»¬å‘ç°äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul>
<li>
<p>ç¬¬ä¸€ï¼Œiowait å¤ªé«˜äº†ï¼Œå¯¼è‡´ç³»ç»Ÿå¹³å‡è´Ÿè½½å‡é«˜ï¼Œå¹¶ä¸”å·²ç»è¾¾åˆ°äº†ç³»ç»Ÿ CPU çš„ä¸ªæ•°ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒï¼Œåƒµå°¸è¿›ç¨‹åœ¨ä¸æ–­å¢å¤šï¼Œçœ‹èµ·æ¥æ˜¯åº”ç”¨ç¨‹åºæ²¡æœ‰æ­£ç¡®æ¸…ç†å­è¿›ç¨‹çš„èµ„æºã€‚</p>
</li>
</ul><p>ç›¸ä¿¡ä½ ä¸€å®šè®¤çœŸæ€è€ƒè¿‡è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆï¼ŒçœŸç›¸åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·é¡ºç€è¿™ä¸¤ä¸ªé—®é¢˜ç»§ç»­åˆ†æï¼Œæ‰¾å‡ºæ ¹æºã€‚</p><p>é¦–å…ˆï¼Œè¯·ä½ æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œç™»å½•åˆ°ä¸Šæ¬¡çš„æœºå™¨ä¸­ã€‚ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œé‡æ–°è¿è¡Œè¿™ä¸ªæ¡ˆä¾‹ï¼š</p><pre><code># å…ˆåˆ é™¤ä¸Šæ¬¡å¯åŠ¨çš„æ¡ˆä¾‹
$ docker rm -f app
# é‡æ–°è¿è¡Œæ¡ˆä¾‹
$ docker run --privileged --name=app -itd feisky/app:iowait
</code></pre><h2>iowait åˆ†æ</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ iowait å‡é«˜çš„é—®é¢˜ã€‚</p><p>æˆ‘ç›¸ä¿¡ï¼Œä¸€æåˆ° iowait å‡é«˜ï¼Œä½ é¦–å…ˆä¼šæƒ³è¦æŸ¥è¯¢ç³»ç»Ÿçš„ I/O æƒ…å†µã€‚æˆ‘ä¸€èˆ¬ä¹Ÿæ˜¯è¿™ç§æ€è·¯ï¼Œé‚£ä¹ˆä»€ä¹ˆå·¥å…·å¯ä»¥æŸ¥è¯¢ç³»ç»Ÿçš„ I/O æƒ…å†µå‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><p>è¿™é‡Œï¼Œæˆ‘æ¨èçš„æ­£æ˜¯ä¸ŠèŠ‚è¯¾è¦æ±‚å®‰è£…çš„ dstat ï¼Œå®ƒçš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥åŒæ—¶æŸ¥çœ‹ CPU å’Œ I/O è¿™ä¸¤ç§èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œä¾¿äºå¯¹æ¯”åˆ†æã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­è¿è¡Œ dstat å‘½ä»¤ï¼Œè§‚å¯Ÿ CPU å’Œ I/O çš„ä½¿ç”¨æƒ…å†µï¼š</p><pre><code># é—´éš”1ç§’è¾“å‡º10ç»„æ•°æ®
$ dstat 1 10
You did not select any stats, using -cdngy by default.
--total-cpu-usage-- -dsk/total- -net/total- ---paging-- ---system--
usr sys idl wai stl| read  writ| recv  send|  in   out | int   csw
  0   0  96   4   0|1219k  408k|   0     0 |   0     0 |  42   885
  0   0   2  98   0|  34M    0 | 198B  790B|   0     0 |  42   138
  0   0   0 100   0|  34M    0 |  66B  342B|   0     0 |  42   135
  0   0  84  16   0|5633k    0 |  66B  342B|   0     0 |  52   177
  0   3  39  58   0|  22M    0 |  66B  342B|   0     0 |  43   144
  0   0   0 100   0|  34M    0 | 200B  450B|   0     0 |  46   147
  0   0   2  98   0|  34M    0 |  66B  342B|   0     0 |  45   134
  0   0   0 100   0|  34M    0 |  66B  342B|   0     0 |  39   131
  0   0  83  17   0|5633k    0 |  66B  342B|   0     0 |  46   168
  0   3  39  59   0|  22M    0 |  66B  342B|   0     0 |  37   134
</code></pre><p>ä» dstat çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¯å½“ iowait å‡é«˜ï¼ˆwaiï¼‰æ—¶ï¼Œç£ç›˜çš„è¯»è¯·æ±‚ï¼ˆreadï¼‰éƒ½ä¼šå¾ˆå¤§ã€‚è¿™è¯´æ˜ iowait çš„å‡é«˜è·Ÿç£ç›˜çš„è¯»è¯·æ±‚æœ‰å…³ï¼Œå¾ˆå¯èƒ½å°±æ˜¯ç£ç›˜è¯»å¯¼è‡´çš„ã€‚</p><p>é‚£åˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹åœ¨è¯»ç£ç›˜å‘¢ï¼Ÿä¸çŸ¥é“ä½ è¿˜è®°ä¸è®°å¾—ï¼Œä¸ŠèŠ‚åœ¨  top  é‡Œçœ‹åˆ°çš„ä¸å¯ä¸­æ–­çŠ¶æ€è¿›ç¨‹ï¼Œæˆ‘è§‰å¾—å®ƒå°±å¾ˆå¯ç–‘ï¼Œæˆ‘ä»¬è¯•ç€æ¥åˆ†æä¸‹ã€‚</p><p>æˆ‘ä»¬ç»§ç»­åœ¨åˆšæ‰çš„ç»ˆç«¯ä¸­ï¼Œè¿è¡Œ top å‘½ä»¤ï¼Œè§‚å¯Ÿ D çŠ¶æ€çš„è¿›ç¨‹ï¼š</p><pre><code># è§‚å¯Ÿä¸€ä¼šå„¿æŒ‰ Ctrl+C ç»“æŸ
$ top
...
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 4340 root      20   0   44676   4048   3432 R   0.3  0.0   0:00.05 top
 4345 root      20   0   37280  33624    860 D   0.3  0.0   0:00.01 app
 4344 root      20   0   37280  33624    860 D   0.3  0.4   0:00.01 app
...

</code></pre><p>æˆ‘ä»¬ä» top çš„è¾“å‡ºæ‰¾åˆ° D çŠ¶æ€è¿›ç¨‹çš„ PIDï¼Œä½ å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªç•Œé¢é‡Œæœ‰ä¸¤ä¸ª D çŠ¶æ€çš„è¿›ç¨‹ï¼ŒPIDåˆ†åˆ«æ˜¯ 4344 å’Œ 4345ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬æŸ¥çœ‹è¿™äº›è¿›ç¨‹çš„ç£ç›˜è¯»å†™æƒ…å†µã€‚å¯¹äº†ï¼Œåˆ«å¿˜äº†å·¥å…·æ˜¯ä»€ä¹ˆã€‚ä¸€èˆ¬è¦æŸ¥çœ‹æŸä¸€ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œéƒ½å¯ä»¥ç”¨æˆ‘ä»¬çš„è€æœ‹å‹ pidstatï¼Œä¸è¿‡è¿™æ¬¡è®°å¾—åŠ ä¸Š -d å‚æ•°ï¼Œä»¥ä¾¿è¾“å‡º I/O ä½¿ç”¨æƒ…å†µã€‚</p><p>æ¯”å¦‚ï¼Œä»¥ 4344 ä¸ºä¾‹ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯é‡Œè¿è¡Œä¸‹é¢çš„ pidstat å‘½ä»¤ï¼Œå¹¶ç”¨ -p 4344 å‚æ•°æŒ‡å®šè¿›ç¨‹å·ï¼š</p><pre><code># -d å±•ç¤º I/O ç»Ÿè®¡æ•°æ®ï¼Œ-p æŒ‡å®šè¿›ç¨‹å·ï¼Œé—´éš” 1 ç§’è¾“å‡º 3 ç»„æ•°æ®
$ pidstat -d -p 4344 1 3
06:38:50      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:38:51        0      4344      0.00      0.00      0.00       0  app
06:38:52        0      4344      0.00      0.00      0.00       0  app
06:38:53        0      4344      0.00      0.00      0.00       0  app
</code></pre><p>åœ¨è¿™ä¸ªè¾“å‡ºä¸­ï¼Œ  kB_rd è¡¨ç¤ºæ¯ç§’è¯»çš„ KB æ•°ï¼Œ kB_wr è¡¨ç¤ºæ¯ç§’å†™çš„ KB æ•°ï¼Œiodelay è¡¨ç¤º I/O çš„å»¶è¿Ÿï¼ˆå•ä½æ˜¯æ—¶é’Ÿå‘¨æœŸï¼‰ã€‚å®ƒä»¬éƒ½æ˜¯ 0ï¼Œé‚£å°±è¡¨ç¤ºæ­¤æ—¶æ²¡æœ‰ä»»ä½•çš„è¯»å†™ï¼Œè¯´æ˜é—®é¢˜ä¸æ˜¯ 4344 è¿›ç¨‹å¯¼è‡´çš„ã€‚</p><p>å¯æ˜¯ï¼Œç”¨åŒæ ·çš„æ–¹æ³•åˆ†æè¿›ç¨‹ 4345ï¼Œä½ ä¼šå‘ç°ï¼Œå®ƒä¹Ÿæ²¡æœ‰ä»»ä½•ç£ç›˜è¯»å†™ã€‚</p><p>é‚£è¦æ€ä¹ˆçŸ¥é“ï¼Œåˆ°åº•æ˜¯å“ªä¸ªè¿›ç¨‹åœ¨è¿›è¡Œç£ç›˜è¯»å†™å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ pidstatï¼Œä½†è¿™æ¬¡å»æ‰è¿›ç¨‹å·ï¼Œå¹²è„†å°±æ¥è§‚å¯Ÿæ‰€æœ‰è¿›ç¨‹çš„ I/O ä½¿ç”¨æƒ…å†µã€‚</p><p>åœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹é¢çš„  pidstat å‘½ä»¤ï¼š</p><pre><code># é—´éš” 1 ç§’è¾“å‡ºå¤šç»„æ•°æ® (è¿™é‡Œæ˜¯ 20 ç»„)
$ pidstat -d 1 20
...
06:48:46      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:47        0      4615      0.00      0.00      0.00       1  kworker/u4:1
06:48:47        0      6080  32768.00      0.00      0.00     170  app
06:48:47        0      6081  32768.00      0.00      0.00     184  app

06:48:47      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:48        0      6080      0.00      0.00      0.00     110  app

06:48:48      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:49        0      6081      0.00      0.00      0.00     191  app

06:48:49      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command

06:48:50      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:51        0      6082  32768.00      0.00      0.00       0  app
06:48:51        0      6083  32768.00      0.00      0.00       0  app

06:48:51      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:52        0      6082  32768.00      0.00      0.00     184  app
06:48:52        0      6083  32768.00      0.00      0.00     175  app

06:48:52      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command
06:48:53        0      6083      0.00      0.00      0.00     105  app
...
</code></pre><p>è§‚å¯Ÿä¸€ä¼šå„¿å¯ä»¥å‘ç°ï¼Œçš„ç¡®æ˜¯ app è¿›ç¨‹åœ¨è¿›è¡Œç£ç›˜è¯»ï¼Œå¹¶ä¸”æ¯ç§’è¯»çš„æ•°æ®æœ‰ 32 MBï¼Œçœ‹æ¥å°±æ˜¯ app çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œapp è¿›ç¨‹åˆ°åº•åœ¨æ‰§è¡Œå•¥ I/O æ“ä½œå‘¢ï¼Ÿ</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾ä¸€ä¸‹è¿›ç¨‹ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åŒºåˆ«ã€‚è¿›ç¨‹æƒ³è¦è®¿é—®ç£ç›˜ï¼Œå°±å¿…é¡»ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ï¼Œé‡ç‚¹å°±æ˜¯æ‰¾å‡º  app è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨äº†ã€‚</p><p>strace  æ­£æ˜¯æœ€å¸¸ç”¨çš„è·Ÿè¸ªè¿›ç¨‹ç³»ç»Ÿè°ƒç”¨çš„å·¥å…·ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä» pidstat çš„è¾“å‡ºä¸­æ‹¿åˆ°è¿›ç¨‹çš„ PID å·ï¼Œæ¯”å¦‚ 6082ï¼Œç„¶ååœ¨ç»ˆç«¯ä¸­è¿è¡Œ strace å‘½ä»¤ï¼Œå¹¶ç”¨ -p å‚æ•°æŒ‡å®š PID å·ï¼š</p><pre><code>$ strace -p 6082
strace: attach: ptrace(PTRACE_SEIZE, 6082): Operation not permitted
</code></pre><p>è¿™å„¿å‡ºç°äº†ä¸€ä¸ªå¥‡æ€ªçš„é”™è¯¯ï¼Œstrace å‘½ä»¤å±…ç„¶å¤±è´¥äº†ï¼Œå¹¶ä¸”å‘½ä»¤æŠ¥å‡ºçš„é”™è¯¯æ˜¯æ²¡æœ‰æƒé™ã€‚æŒ‰ç†æ¥è¯´ï¼Œæˆ‘ä»¬æ‰€æœ‰æ“ä½œéƒ½å·²ç»æ˜¯ä»¥ root ç”¨æˆ·è¿è¡Œäº†ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæ²¡æœ‰æƒé™å‘¢ï¼Ÿä½ ä¹Ÿå¯ä»¥å…ˆæƒ³ä¸€ä¸‹ï¼Œç¢°åˆ°è¿™ç§æƒ…å†µï¼Œä½ ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p><strong>ä¸€èˆ¬é‡åˆ°è¿™ç§é—®é¢˜æ—¶ï¼Œæˆ‘ä¼šå…ˆæ£€æŸ¥ä¸€ä¸‹è¿›ç¨‹çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸</strong>ã€‚æ¯”å¦‚ï¼Œç»§ç»­åœ¨ç»ˆç«¯ä¸­è¿è¡Œ ps å‘½ä»¤ï¼Œå¹¶ä½¿ç”¨ grep æ‰¾å‡ºåˆšæ‰çš„ 6082 å·è¿›ç¨‹ï¼š</p><pre><code>$ ps aux | grep 6082
root      6082  0.0  0.0      0     0 pts/0    Z+   13:43   0:00 [app] &lt;defunct&gt;
</code></pre><p>æœç„¶ï¼Œè¿›ç¨‹ 6082 å·²ç»å˜æˆäº† Z çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯åƒµå°¸è¿›ç¨‹ã€‚åƒµå°¸è¿›ç¨‹éƒ½æ˜¯å·²ç»é€€å‡ºçš„è¿›ç¨‹ï¼Œæ‰€ä»¥å°±æ²¡æ³•å„¿ç»§ç»­åˆ†æå®ƒçš„ç³»ç»Ÿè°ƒç”¨ã€‚å…³äºåƒµå°¸è¿›ç¨‹çš„å¤„ç†æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€ä¼šå„¿å†è¯´ï¼Œç°åœ¨è¿˜æ˜¯ç»§ç»­åˆ†æ iowait çš„é—®é¢˜ã€‚</p><p>åˆ°è¿™ä¸€æ­¥ï¼Œä½ åº”è¯¥æ³¨æ„åˆ°äº†ï¼Œç³»ç»Ÿ iowait çš„é—®é¢˜è¿˜åœ¨ç»§ç»­ï¼Œä½†æ˜¯  topã€pidstat  è¿™ç±»å·¥å…·å·²ç»ä¸èƒ½ç»™å‡ºæ›´å¤šçš„ä¿¡æ¯äº†ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±åº”è¯¥æ±‚åŠ©é‚£äº›åŸºäºäº‹ä»¶è®°å½•çš„åŠ¨æ€è¿½è¸ªå·¥å…·äº†ã€‚</p><p>ä½ å¯ä»¥ç”¨  perf top çœ‹çœ‹æœ‰æ²¡æœ‰æ–°å‘ç°ã€‚å†æˆ–è€…ï¼Œå¯ä»¥åƒæˆ‘ä¸€æ ·ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œ perf recordï¼ŒæŒç»­ä¸€ä¼šå„¿ï¼ˆä¾‹å¦‚ 15 ç§’ï¼‰ï¼Œç„¶åæŒ‰ Ctrl+C é€€å‡ºï¼Œå†è¿è¡Œ perf report æŸ¥çœ‹æŠ¥å‘Šï¼š</p><pre><code>$ perf record -g
$ perf report
</code></pre><p>æ¥ç€ï¼Œæ‰¾åˆ°æˆ‘ä»¬å…³æ³¨çš„ app è¿›ç¨‹ï¼ŒæŒ‰å›è½¦é”®å±•å¼€è°ƒç”¨æ ˆï¼Œä½ å°±ä¼šå¾—åˆ°ä¸‹é¢è¿™å¼ è°ƒç”¨å…³ç³»å›¾ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/21/a1/21e79416e946ed049317a4b4c5a576a1.png" alt=""></p><p>è¿™ä¸ªå›¾é‡Œçš„swapper æ˜¯å†…æ ¸ä¸­çš„è°ƒåº¦è¿›ç¨‹ï¼Œä½ å¯ä»¥å…ˆå¿½ç•¥æ‰ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹å…¶ä»–ä¿¡æ¯ï¼Œä½ å¯ä»¥å‘ç°ï¼Œ app çš„ç¡®åœ¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨ sys_read() è¯»å–æ•°æ®ã€‚å¹¶ä¸”ä» new_sync_read å’Œ blkdev_direct_IO  èƒ½çœ‹å‡ºï¼Œè¿›ç¨‹æ­£åœ¨å¯¹ç£ç›˜è¿›è¡Œ<strong>ç›´æ¥è¯»</strong>ï¼Œä¹Ÿå°±æ˜¯ç»•è¿‡äº†ç³»ç»Ÿç¼“å­˜ï¼Œæ¯ä¸ªè¯»è¯·æ±‚éƒ½ä¼šä»ç£ç›˜ç›´æ¥è¯»ï¼Œè¿™å°±å¯ä»¥è§£é‡Šæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„ iowait å‡é«˜äº†ã€‚</p><p>çœ‹æ¥ï¼Œç½ªé­ç¥¸é¦–æ˜¯ app å†…éƒ¨è¿›è¡Œäº†ç£ç›˜çš„ç›´æ¥ I/Oå•Šï¼</p><p>ä¸‹é¢çš„é—®é¢˜å°±å®¹æ˜“è§£å†³äº†ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥åº”è¯¥ä»ä»£ç å±‚é¢åˆ†æï¼Œç©¶ç«Ÿæ˜¯å“ªé‡Œå‡ºç°äº†ç›´æ¥è¯»è¯·æ±‚ã€‚æŸ¥çœ‹æºç æ–‡ä»¶ <a href="https://github.com/feiskyer/linux-perf-examples/blob/master/high-iowait-process/app.c">app.c</a>ï¼Œä½ ä¼šå‘ç°å®ƒæœç„¶ä½¿ç”¨äº† O_DIRECT é€‰é¡¹æ‰“å¼€ç£ç›˜ï¼Œäºæ˜¯ç»•è¿‡äº†ç³»ç»Ÿç¼“å­˜ï¼Œç›´æ¥å¯¹ç£ç›˜è¿›è¡Œè¯»å†™ã€‚</p><pre><code>open(disk, O_RDONLY|O_DIRECT|O_LARGEFILE, 0755)
</code></pre><p>ç›´æ¥è¯»å†™ç£ç›˜ï¼Œå¯¹ I/O æ•æ„Ÿå‹åº”ç”¨ï¼ˆæ¯”å¦‚æ•°æ®åº“ç³»ç»Ÿï¼‰æ˜¯å¾ˆå‹å¥½çš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åº”ç”¨ä¸­ï¼Œç›´æ¥æ§åˆ¶ç£ç›˜çš„è¯»å†™ã€‚ä½†åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ€å¥½è¿˜æ˜¯é€šè¿‡ç³»ç»Ÿç¼“å­˜æ¥ä¼˜åŒ–ç£ç›˜ I/Oï¼Œæ¢å¥è¯è¯´ï¼Œåˆ é™¤ O_DIRECT è¿™ä¸ªé€‰é¡¹å°±æ˜¯äº†ã€‚</p><p><a href="https://github.com/feiskyer/linux-perf-examples/blob/master/high-iowait-process/app-fix1.c">app-fix1.c</a> å°±æ˜¯ä¿®æ”¹åçš„æ–‡ä»¶ï¼Œæˆ‘ä¹Ÿæ‰“åŒ…æˆäº†ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½ å°±å¯ä»¥å¯åŠ¨å®ƒäº†ï¼š</p><pre><code># é¦–å…ˆåˆ é™¤åŸæ¥çš„åº”ç”¨
$ docker rm -f app
# è¿è¡Œæ–°çš„åº”ç”¨
$ docker run --privileged --name=app -itd feisky/app:iowait-fix1
</code></pre><p>æœ€åï¼Œå†ç”¨ top æ£€æŸ¥ä¸€ä¸‹ï¼š</p><pre><code>$ top
top - 14:59:32 up 19 min,  1 user,  load average: 0.15, 0.07, 0.05
Tasks: 137 total,   1 running,  72 sleeping,   0 stopped,  12 zombie
%Cpu0  :  0.0 us,  1.7 sy,  0.0 ni, 98.0 id,  0.3 wa,  0.0 hi,  0.0 si,  0.0 st
%Cpu1  :  0.0 us,  1.3 sy,  0.0 ni, 98.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
...

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 3084 root      20   0       0      0      0 Z   1.3  0.0   0:00.04 app
 3085 root      20   0       0      0      0 Z   1.3  0.0   0:00.04 app
    1 root      20   0  159848   9120   6724 S   0.0  0.1   0:09.03 systemd
    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd
    3 root      20   0       0      0      0 I   0.0  0.0   0:00.40 kworker/0:0
...
</code></pre><p>ä½ ä¼šå‘ç°ï¼Œ iowait å·²ç»éå¸¸ä½äº†ï¼Œåªæœ‰ 0.3%ï¼Œè¯´æ˜åˆšæ‰çš„æ”¹åŠ¨å·²ç»æˆåŠŸä¿®å¤äº† iowait é«˜çš„é—®é¢˜ï¼Œå¤§åŠŸå‘Šæˆï¼ä¸è¿‡ï¼Œåˆ«å¿˜äº†ï¼Œåƒµå°¸è¿›ç¨‹è¿˜åœ¨ç­‰ç€ä½ ã€‚ä»”ç»†è§‚å¯Ÿåƒµå°¸è¿›ç¨‹çš„æ•°é‡ï¼Œä½ ä¼šéƒé—·åœ°å‘ç°ï¼Œåƒµå°¸è¿›ç¨‹è¿˜åœ¨ä¸æ–­çš„å¢é•¿ä¸­ã€‚</p><h2>åƒµå°¸è¿›ç¨‹</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å¤„ç†åƒµå°¸è¿›ç¨‹çš„é—®é¢˜ã€‚æ—¢ç„¶åƒµå°¸è¿›ç¨‹æ˜¯å› ä¸ºçˆ¶è¿›ç¨‹æ²¡æœ‰å›æ”¶å­è¿›ç¨‹çš„èµ„æºè€Œå‡ºç°çš„ï¼Œé‚£ä¹ˆï¼Œè¦è§£å†³æ‰å®ƒä»¬ï¼Œå°±è¦æ‰¾åˆ°å®ƒä»¬çš„æ ¹å„¿ï¼Œ<strong>ä¹Ÿå°±æ˜¯æ‰¾å‡ºçˆ¶è¿›ç¨‹ï¼Œç„¶ååœ¨çˆ¶è¿›ç¨‹é‡Œè§£å†³ã€‚</strong></p><p>çˆ¶è¿›ç¨‹çš„æ‰¾æ³•æˆ‘ä»¬å‰é¢è®²è¿‡ï¼Œæœ€ç®€å•çš„å°±æ˜¯è¿è¡Œ  pstree å‘½ä»¤ï¼š</p><pre><code># -a è¡¨ç¤ºè¾“å‡ºå‘½ä»¤è¡Œé€‰é¡¹
# pè¡¨PID
# sè¡¨ç¤ºæŒ‡å®šè¿›ç¨‹çš„çˆ¶è¿›ç¨‹
$ pstree -aps 3084
systemd,1
  â””â”€dockerd,15006 -H fd://
      â””â”€docker-containe,15024 --config /var/run/docker/containerd/containerd.toml
          â””â”€docker-containe,3991 -namespace moby -workdir...
              â””â”€app,4009
                  â””â”€(app,3084)
</code></pre><p>è¿è¡Œå®Œï¼Œä½ ä¼šå‘ç° 3084 å·è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯ 4009ï¼Œä¹Ÿå°±æ˜¯ app åº”ç”¨ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥ç€æŸ¥çœ‹ app åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œçœ‹çœ‹å­è¿›ç¨‹ç»“æŸçš„å¤„ç†æ˜¯å¦æ­£ç¡®ï¼Œæ¯”å¦‚æœ‰æ²¡æœ‰è°ƒç”¨ wait() æˆ– waitpid() ï¼ŒæŠ‘æˆ–æ˜¯ï¼Œæœ‰æ²¡æœ‰æ³¨å†Œ SIGCHLD ä¿¡å·çš„å¤„ç†å‡½æ•°ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æŸ¥çœ‹ä¿®å¤ iowait åçš„æºç æ–‡ä»¶ <a href="https://github.com/feiskyer/linux-perf-examples/blob/master/high-iowait-process/app-fix1.c">app-fix1.c</a> ï¼Œæ‰¾åˆ°å­è¿›ç¨‹çš„åˆ›å»ºå’Œæ¸…ç†çš„åœ°æ–¹ï¼š</p><pre><code>int status = 0;
  for (;;) {
    for (int i = 0; i &lt; 2; i++) {
      if(fork()== 0) {
        sub_process();
      }
    }
    sleep(5);
  }

  while(wait(&amp;status)&gt;0);
</code></pre><p>å¾ªç¯è¯­å¥æœ¬æ¥å°±å®¹æ˜“å‡ºé”™ï¼Œä½ èƒ½æ‰¾åˆ°è¿™é‡Œçš„é—®é¢˜å—ï¼Ÿè¿™æ®µä»£ç è™½ç„¶çœ‹èµ·æ¥è°ƒç”¨äº† wait() å‡½æ•°ç­‰å¾…å­è¿›ç¨‹ç»“æŸï¼Œä½†å´é”™è¯¯åœ°æŠŠ wait() æ”¾åˆ°äº† for æ­»å¾ªç¯çš„å¤–é¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œwait() å‡½æ•°å®é™…ä¸Šå¹¶æ²¡è¢«è°ƒç”¨åˆ°ï¼Œæˆ‘ä»¬æŠŠå®ƒæŒªåˆ° for å¾ªç¯çš„é‡Œé¢å°±å¯ä»¥äº†ã€‚</p><p>ä¿®æ”¹åçš„æ–‡ä»¶æˆ‘æ”¾åˆ°äº† <a href="https://github.com/feiskyer/linux-perf-examples/blob/master/high-iowait-process/app-fix2.c">app-fix2.c</a> ä¸­ï¼Œä¹Ÿæ‰“åŒ…æˆäº†ä¸€ä¸ª Docker é•œåƒï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½ å°±å¯ä»¥å¯åŠ¨å®ƒï¼š</p><pre><code># å…ˆåœæ­¢äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„ app
$ docker rm -f app
# ç„¶åå¯åŠ¨æ–°çš„ app
$ docker run --privileged --name=app -itd feisky/app:iowait-fix2
</code></pre><p>å¯åŠ¨åï¼Œå†ç”¨ top æœ€åæ¥æ£€æŸ¥ä¸€éï¼š</p><pre><code>$ top
top - 15:00:44 up 20 min,  1 user,  load average: 0.05, 0.05, 0.04
Tasks: 125 total,   1 running,  72 sleeping,   0 stopped,   0 zombie
%Cpu0  :  0.0 us,  1.7 sy,  0.0 ni, 98.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
%Cpu1  :  0.0 us,  1.3 sy,  0.0 ni, 98.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
...

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 3198 root      20   0    4376    840    780 S   0.3  0.0   0:00.01 app
    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd
    3 root      20   0       0      0      0 I   0.0  0.0   0:00.41 kworker/0:0
...
</code></pre><p>å¥½äº†ï¼Œåƒµå°¸è¿›ç¨‹ï¼ˆZçŠ¶æ€ï¼‰æ²¡æœ‰äº†ï¼Œ iowait  ä¹Ÿæ˜¯ 0ï¼Œé—®é¢˜ç»ˆäºå…¨éƒ¨è§£å†³äº†ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©æˆ‘ç”¨ä¸€ä¸ªå¤šè¿›ç¨‹çš„æ¡ˆä¾‹ï¼Œå¸¦ä½ åˆ†æç³»ç»Ÿç­‰å¾… I/O çš„ CPU ä½¿ç”¨ç‡ï¼ˆä¹Ÿå°±æ˜¯ iowait%ï¼‰å‡é«˜çš„æƒ…å†µã€‚</p><p>è™½ç„¶è¿™ä¸ªæ¡ˆä¾‹æ˜¯ç£ç›˜ I/O å¯¼è‡´äº† iowait å‡é«˜ï¼Œä¸è¿‡ï¼Œ <strong>iowait é«˜ä¸ä¸€å®šä»£è¡¨I/O æœ‰æ€§èƒ½ç“¶é¢ˆã€‚å½“ç³»ç»Ÿä¸­åªæœ‰ I/O ç±»å‹çš„è¿›ç¨‹åœ¨è¿è¡Œæ—¶ï¼Œiowait ä¹Ÿä¼šå¾ˆé«˜ï¼Œä½†å®é™…ä¸Šï¼Œç£ç›˜çš„è¯»å†™è¿œæ²¡æœ‰è¾¾åˆ°æ€§èƒ½ç“¶é¢ˆçš„ç¨‹åº¦</strong>ã€‚</p><p>å› æ­¤ï¼Œç¢°åˆ° iowait å‡é«˜æ—¶ï¼Œéœ€è¦å…ˆç”¨ dstatã€pidstat ç­‰å·¥å…·ï¼Œç¡®è®¤æ˜¯ä¸æ˜¯ç£ç›˜ I/O çš„é—®é¢˜ï¼Œç„¶åå†æ‰¾æ˜¯å“ªäº›è¿›ç¨‹å¯¼è‡´äº† I/Oã€‚</p><p>ç­‰å¾… I/O çš„è¿›ç¨‹ä¸€èˆ¬æ˜¯ä¸å¯ä¸­æ–­çŠ¶æ€ï¼Œæ‰€ä»¥ç”¨ ps å‘½ä»¤æ‰¾åˆ°çš„ D çŠ¶æ€ï¼ˆå³ä¸å¯ä¸­æ–­çŠ¶æ€ï¼‰çš„è¿›ç¨‹ï¼Œå¤šä¸ºå¯ç–‘è¿›ç¨‹ã€‚ä½†è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œåœ¨ I/O æ“ä½œåï¼Œè¿›ç¨‹åˆå˜æˆäº†åƒµå°¸è¿›ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ strace ç›´æ¥åˆ†æè¿™ä¸ªè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨äº† perf å·¥å…·ï¼Œæ¥åˆ†æç³»ç»Ÿçš„ CPU æ—¶é’Ÿäº‹ä»¶ï¼Œæœ€ç»ˆå‘ç°æ˜¯ç›´æ¥ I/O å¯¼è‡´çš„é—®é¢˜ã€‚è¿™æ—¶ï¼Œå†æ£€æŸ¥æºç ä¸­å¯¹åº”ä½ç½®çš„é—®é¢˜ï¼Œå°±å¾ˆè½»æ¾äº†ã€‚</p><p>è€Œåƒµå°¸è¿›ç¨‹çš„é—®é¢˜ç›¸å¯¹å®¹æ˜“æ’æŸ¥ï¼Œä½¿ç”¨ pstree æ‰¾å‡ºçˆ¶è¿›ç¨‹åï¼Œå»æŸ¥çœ‹çˆ¶è¿›ç¨‹çš„ä»£ç ï¼Œæ£€æŸ¥ wait() / waitpid() çš„è°ƒç”¨ï¼Œæˆ–æ˜¯ SIGCHLD ä¿¡å·å¤„ç†å‡½æ•°çš„æ³¨å†Œå°±è¡Œäº†ã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œæˆ‘æƒ³é‚€è¯·ä½ ä¸€èµ·æ¥èŠèŠï¼Œä½ ç¢°åˆ°è¿‡çš„ä¸å¯ä¸­æ–­çŠ¶æ€è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹é—®é¢˜ã€‚ä½ æ˜¯æ€ä¹ˆåˆ†æå®ƒä»¬çš„æ ¹æºï¼Ÿåˆæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿåœ¨ä»Šå¤©çš„æ¡ˆä¾‹æ“ä½œä¸­ï¼Œä½ åˆæœ‰ä»€ä¹ˆæ–°çš„å‘ç°å—ï¼Ÿä½ å¯ä»¥ç»“åˆæˆ‘çš„è®²è¿°ï¼Œæ€»ç»“è‡ªå·±çš„æ€è·¯ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/56/52/565d66d658ad23b2f4997551db153852.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/ea/72/94a0d7fc.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">zecho</span>
                            </div>
                            <div class="bd">æä¸€ä¸ªå»ºè®®ï¼Œæ¡ˆä¾‹çš„è®²è§£è¿‡äºç®€å•ï¼Œä¸é¢„æœŸæœ‰äº›å·®è·ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å®é™…é‡åˆ°çš„è¦æ¯”è¿™ä¸ªå¤æ‚ï¼Œè¿™ä¼šå¸¦æ¥ä¸æ˜¯ç®€å•çš„å‡ ä¸ªå‘½ä»¤å°±å¯ä»¥ï¼Œç‰¹åˆ«éœ€è¦æ›´æ·±å…¥çš„å·¥å…·ï¼Œæ¯”å¦‚brendanä¸­ç«ç„°å›¾ï¼Œperf-toolsï¼Œæˆ–è€…systemtabç­‰ç­‰ï¼›å¸Œæœ›èƒ½æ‰¾äº›å®é™…çš„æ¡ˆä¾‹ï¼Œè°¢è°¢ã€‚ <br></div>
                            <span class="time">2018-12-07 08:49</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ï¼Œå®é™…ä¸Šè¿™é‡Œçš„æ¡ˆä¾‹æ˜¯æˆ‘æ•…æ„è®¾è®¡çš„æ¯”è¾ƒç®€å•ï¼Œè¿™æ ·åˆå­¦è€…å¯ä»¥æŠŠé‡ç‚¹æ”¾åˆ°ç†è§£å½“å‰è®²çš„åŸç†å’ŒæŒ‡æ ‡ä¸Šï¼Œè€Œä¸æ˜¯çœ‹ç€ä¸€å †çš„æ–°å·¥å…·å’Œå†…æ ¸å‡½æ•°è€Œæ„Ÿåˆ°å®³æ€•ã€‚å½“ç„¶äº†ï¼Œç«ç„°å›¾ã€perf-toolsã€systemtapè¿™äº›å·¥å…·ä»¥åä¹Ÿä¼šè®²åˆ°ï¼Œåªæ˜¯è¿˜æ˜¯è®©æˆ‘ä»¬å…ˆæŠŠåŸºç¡€çš„ä¸œè¥¿é“ºå«å¥½ã€‚<br><br>å¦‚æœä½ å·²ç»å¯¹è¿™äº›æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œæ¨èå»æŠŠè¿™äº›æ€è·¯åº”ç”¨åˆ°å®é™…çš„ç³»ç»Ÿä¸­å»åˆ†æï¼Œç„¶ååœ¨è¿™é‡Œè·Ÿå¤§å®¶åˆ†äº«ä½ çš„æ‰€å¾—ã€‚æˆ‘ç›¸ä¿¡ï¼Œä½ æœ‰å¯èƒ½ä¼šå‘ç°ä¸åŒçš„ç†è§£ï¼Œç”šè‡³æ˜¯æ›´å¥½çš„åˆ†ææ€è·¯ã€‚</p>
                                <p class="reply-time">2018-12-08 22:06</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/11/fe/de00d8d8.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ç‹æ¶›</span>
                            </div>
                            <div class="bd">d8æ‰“å¡ã€‚çœ‹å®Œè¿™éƒ¨åˆ†ï¼Œä½œä¸ºä¸€åè¿ç»´äººå‘˜å°±å°´å°¬äº†ï¼Œå½“å¼€å‘è·Ÿä½ è¯´æœºå™¨æ€§èƒ½æœ‰é—®é¢˜æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å°±å˜æˆäº†ç”©é”…é—®é¢˜ã€‚å¼€å‘è¯´ä»£ç æ²¡é—®é¢˜ï¼Œä½ åˆçœ‹ä¸æ‡‚å¼€å‘çš„ä»£ç ã€‚ã€‚ã€‚ <br></div>
                            <span class="time">2018-12-07 08:59</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ‰¾å‡ºè¿›ç¨‹å°±å¯ä»¥ç”©é”…äº†ğŸ˜Š<br><br>ä»ç£ç›˜IOçš„è§’åº¦æ¥è¯´ï¼Œå…¶å®å¾ˆå®¹æ˜“æ‰¾å‡ºé‚£äº›è¿›ç¨‹åœ¨æ¶ˆè€—IOèµ„æºã€‚å› ä¸ºè¿™é‡Œä¾§é‡çš„æ˜¯CPUä½¿ç”¨çš„åˆ†æï¼Œæ‰€ä»¥IOè®²çš„ä¸æ˜¯ç‰¹åˆ«æ·±å…¥ã€‚åç»­çš„IOéƒ¨åˆ†è¿˜ä¼šæœ‰æ›´ç»†è‡´çš„æ‹†è§£ã€‚</p>
                                <p class="reply-time">2018-12-08 22:09</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/34/bb/0b971fca.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">walker</span>
                            </div>
                            <div class="bd">æœ‰æ—¶å€™ç›´æ¥æ€æ­»åƒµå°¸è¿›ç¨‹çš„æ—¶å€™ä¼šå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ï¼Œæˆ–æ˜¯å´©æºƒã€‚åœ¨çº¿ä¸Šè¿è¡Œçš„æœåŠ¡å‡ºç°åƒµå°¸è¿›ç¨‹æ—¶ï¼Œæ€æ ·å¤„ç†æ¯”è¾ƒå¥½å‘¢ï¼Ÿ <br></div>
                            <span class="time">2018-12-07 10:11</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/20/80/d61ad0cc.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸ¯é”¦ç²(ä¾ å®¢è¡Œ)</span>
                            </div>
                            <div class="bd">docké•œåƒç­‰èµ„æ–™åœ¨å“ªé‡Œä¸‹è½½ï¼Ÿ <br></div>
                            <span class="time">2018-12-07 07:43</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ¯å¤©æ™’ç™½ç‰™</span>
                            </div>
                            <div class="bd">ã€D8æ‰“å¡ã€‘<br>ä»Šå¤©ä¸»è¦å­¦ä¹ çš„æ˜¯ç³»ç»Ÿä¸­å‡ºç°äº†å¤§é‡ä¸å¯ä¸­æ–­è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹çš„å¤„ç†æ–¹æ³•<br>ç°è±¡ï¼š<br>â‘ iowaitå¤ªé«˜ï¼Œå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜ï¼Œå¹¶ä¸”è¾¾åˆ°äº†ç³»ç»ŸCPUçš„ä¸ªæ•°<br>â‘¡åƒµå°¸è¿›ç¨‹ä¸æ–­å¢å¤š<br>åˆ†æè¿‡ç¨‹ï¼š<br>1.å…ˆåˆ†æiowaitå‡é«˜çš„åŸå› <br>ä¸€èˆ¬iowaitå‡é«˜ï¼Œå¯èƒ½çš„åŸå› æ˜¯i&#47;oé—®é¢˜<br>â‘ ç”¨dstat å‘½ä»¤åŒæ—¶æŸ¥çœ‹cpuå’Œi&#47;oå¯¹æ¯”æƒ…å†µï¼ˆå¦‚ dstat 1 10 é—´éš”1ç§’è¾“å‡º10ç»„æ•°æ®ï¼‰ï¼Œé€šè¿‡ç»“æœå¯ä»¥å‘ç°iowaitå‡é«˜æ—¶ï¼Œç£ç›˜è¯»è¯·æ±‚ï¼ˆreadï¼‰å‡é«˜<br>æ‰€ä»¥æ¨æ–­iowaitå‡é«˜æ˜¯ç£ç›˜è¯»å¯¼è‡´<br>â‘¡å®šä½ç£ç›˜è¯»çš„è¿›ç¨‹ï¼Œä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹å¤„äºä¸å¯ä¸­æ–­çŠ¶æ€ï¼ˆDï¼‰çš„è¿›ç¨‹PID<br>â‘¢æŸ¥çœ‹å¯¹åº”è¿›ç¨‹çš„ç£ç›˜è¯»å†™æƒ…å†µï¼Œä½¿ç”¨pidstatå‘½ä»¤ï¼ŒåŠ ä¸Š-då‚æ•°ï¼Œå¯ä»¥çœ‹åˆ°i&#47;oä½¿ç”¨æƒ…å†µï¼ˆå¦‚ pidstat -d -p &lt;pid&gt; 1 3ï¼‰,å‘ç°å¤„äºä¸å¯ä¸­æ–­çŠ¶æ€çš„è¿›ç¨‹éƒ½æ²¡æœ‰è¿›è¡Œç£ç›˜è¯»å†™<br>â‘£ç»§ç»­ä½¿ç”¨pidstatå‘½ä»¤ï¼Œä½†æ˜¯å»æ‰è¿›ç¨‹å·ï¼ŒæŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„i&#47;oæƒ…å†µï¼ˆpidstat -d 1 20ï¼‰ï¼Œå¯ä»¥å®šä½åˆ°è¿›è¡Œç£ç›˜è¯»å†™çš„è¿›ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“è¿›ç¨‹è®¿é—®ç£ç›˜ï¼Œéœ€è¦ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œ<br>ä¸‹é¢çš„é‡ç‚¹å°±æ˜¯æ‰¾åˆ°è¯¥è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨<br>â‘¤ä½¿ç”¨straceæŸ¥çœ‹è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ strace -p &lt;pid&gt;<br>å‘ç°æŠ¥äº† strace:attach :ptrace(PTRACE_SIZEï¼Œ6028)ï¼šOperation not peritted,è¯´æ²¡æœ‰æƒé™ï¼Œæˆ‘æ˜¯ä½¿ç”¨çš„rootæƒé™ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±è¦æŸ¥çœ‹è¿›ç¨‹çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸<br>â‘¥ps aux | grep &lt;pid&gt; å‘ç°è¿›ç¨‹å¤„äºZçŠ¶æ€ï¼Œå·²ç»å˜æˆäº†åƒµå°¸è¿›ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½è¿›è¡Œç³»ç»Ÿè°ƒç”¨åˆ†æäº†<br>â‘¦æ—¢ç„¶topå’Œpidstatéƒ½ä¸èƒ½æ‰¾å‡ºé—®é¢˜ï¼Œä½¿ç”¨åŸºäºäº‹ä»¶è®°å½•çš„åŠ¨æ€è¿½è¸ªå·¥å…·<br>å¦‚æœæ˜¯centosç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•<br>åœ¨å®¹å™¨å¤–é¢æŠŠåˆ†æè®°å½•ä¿å­˜ï¼Œåˆ°å®¹å™¨é‡Œé¢æŸ¥çœ‹ç»“æœ<br>æ“ä½œï¼š<br>ï¼ˆ1ï¼‰åœ¨centosç³»ç»Ÿä¸Šè¿è¡Œ perf record -g ï¼Œæ‰§è¡Œä¸€ä¼šå„¿æŒ‰ctrl+cåœæ­¢<br>ï¼ˆ2ï¼‰æŠŠç”Ÿæˆçš„perf.dataï¼ˆé€šå¸¸æ–‡ä»¶ç”Ÿæˆåœ¨å‘½ä»¤æ‰§è¡Œçš„å½“å‰ç›®å½•ä¸‹ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡find | grep perf.dataæˆ– find &#47; -name perf.dataæŸ¥çœ‹è·¯å¾„ï¼‰æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨é‡Œé¢åˆ†æï¼š<br>docker cp perf.data app:&#47;tpm<br>docker exec -i -t app bash<br>cd &#47;tmp&#47;<br>apt-get update &amp;&amp; apt-get install -y linux-perf linux-tools procps<br>perf_4.9 report<br>ç„¶åè§‚å¯Ÿè°ƒç”¨æ ˆä¿¡æ¯ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ç£ç›˜è¯»æ“ä½œï¼Œè¿™ä¸ªæ¡ˆä¾‹æ˜¯å®šä½åˆ°äº†è¿›è¡Œç£ç›˜çš„ç›´æ¥è¯»ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŸ¥çœ‹æºç è¿›è¡ŒéªŒè¯ã€‚å› ä¸ºæˆ‘çš„centosç³»ç»Ÿç”¨è€å¸ˆçš„ iowaité•œåƒiowaitå‡é«˜ä¸æ˜æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ˜¯iowait-new2é•œåƒï¼Œå¯ä»¥å¾—åˆ°æƒ³è¦çš„ç»“æœï¼Œä½†æ˜¯è¿™ä¸ªé•œåƒæŠŠæˆ‘çš„ç³»ç»Ÿèƒ½æå´©æºƒï¼Œæ‰€ä»¥æˆ‘åªèƒ½æ‰§è¡Œåˆ°cd &#47;tmp&#47;è¿™æ­¥ï¼Œä¸‹é¢é‚£éƒ¨å°±æ‰§è¡Œä¸ä¸‹å»äº†ã€‚ä½†æ˜¯æ•´ä¸ªåˆ†æè¿‡ç¨‹è¿˜æ˜¯ç†è§£äº†ã€‚<br><br>2.åƒµå°¸è¿›ç¨‹<br>åƒµå°¸è¿›ç¨‹å‡ºç°çš„åŸå› æ˜¯çˆ¶è¿›ç¨‹æ²¡æœ‰å›æ”¶å­è¿›ç¨‹çš„èµ„æºå‡ºç°çš„ã€‚è§£å†³åŠæ³•æ˜¯æ‰¾åˆ°çˆ¶è¿›ç¨‹ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­å¤„ç†ï¼Œä½¿ç”¨pstreeæŸ¥çˆ¶è¿›ç¨‹ï¼Œç„¶åæŸ¥çœ‹çˆ¶è¿›ç¨‹çš„æºç æ£€æŸ¥wait()&#47;waitpid()çš„è°ƒç”¨æˆ–SIGCHLDä¿¡å·å¤„ç†å‡½æ•°çš„æ³¨å†Œ <br></div>
                            <span class="time">2018-12-07 07:49</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/13/52/db1b01fc.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ç™½å</span>
                            </div>
                            <div class="bd">ä»Šå¤©è¿›è¡Œå®éªŒçœ‹æ¥è¿˜æ˜¯ä¸ä¼šæˆåŠŸçš„ï¼Œä¸Šæ¬¡åœ¨ä½ çš„docker hubä»“åº“ä¸­çœ‹åˆ°äº†iowaité•œåƒï¼Œè¯•äº†æœ€æ–°çš„å‡ ä¸ªï¼Œåœ¨centos7è™šæ‹Ÿæœºä¸­è¿˜æ˜¯ä¸è¡Œ <br></div>
                            <span class="time">2018-12-07 07:14</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/1b/82/69581d8a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å§œå°é±¼</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼šiowait%ç”Ÿé«˜å¹¶ä¸èƒ½å¾—å‡ºå­˜åœ¨ioæ€§èƒ½çš„ç»“è®ºï¼Œè¿˜è¦ç»§ç»­çœ‹ioé‡(dstat)å’Œioå¹¶å‘ç­‰æƒ…å†µ.é‚£ä¹ˆè¿™ä¸ªioé‡åˆ°åº•è¾¾åˆ°å¤šå°‘æ‰èƒ½è¯´æ˜å­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Ÿæœ‰ä¸€ä¸ªé‡åŒ–æŒ‡æ ‡å—ï¼ŸæœŸå¾…å›å¤ï¼Œè°¢è°¢ <br></div>
                            <span class="time">2018-12-07 14:06</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">IOéƒ¨åˆ†ä¼šè®²çš„</p>
                                <p class="reply-time">2018-12-08 16:19</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æˆ‘æ¥ä¹Ÿ</span>
                            </div>
                            <div class="bd">[D8æ‰“å¡]<br>ä»Šå¤©åˆå­¦äº†ä¸¤ä¸ªä¹–, dstatå¯ä»¥åŒæ—¶çœ‹cpuå’Œio. (ä¸Šç¯‡æ–‡ç« å®‰è£…ååªçœ‹äº†ä¸‹æ•ˆæœ,æ²¡æƒ³åˆ°è¿™ä¸€å±‚).straceå¯ä»¥è¿½è¸ªç³»ç»Ÿè°ƒç”¨.<br>è™½ç„¶æˆ‘ä¹‹å‰ä¹Ÿå†™è¿‡linux cç¨‹åº,ä½†æ˜¯çœ‹åˆ°sys_read&#47;new_sync_read&#47;blkdev_direct_IOç¡®å®ä¸çŸ¥é“æ˜¯æ­£åœ¨å¯¹ç£ç›˜è¿›è¡Œç›´æ¥è¯», å³ä½¿çœ‹äº†ä»£ç  ä¹Ÿä¸çŸ¥é“ O_DIRECT è¿™ä¸ªå‚æ•°å°±æ˜¯ç›´æ¥è¯».<br>è¿˜æ˜¯åŠŸåŠ›å¤ªæµ…,çº¿ç´¢æ‘†åœ¨å‰é¢ä¹ŸæŠ“ä¸ä½,å“ˆå“ˆğŸ˜.<br>----<br>æœ‰äº›åŒå­¦é—®&quot;æœåŠ¡å‡ºç°åƒµå°¸è¿›ç¨‹æ—¶ï¼Œæ€æ ·å¤„ç†&quot;.<br>å…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå¤„ç†,ä½†æ˜¯æˆ‘æŠŠé‚£ä¸ªçˆ¶è¿›ç¨‹æ€æ‰, åƒµå°¸è¿›ç¨‹å°±å‡ ä¹æ²¡æœ‰äº†. <br>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­,è€å¸ˆä¹Ÿæåˆ°è¿‡[é€šå¸¸ï¼Œåƒµå°¸è¿›ç¨‹æŒç»­çš„æ—¶é—´éƒ½æ¯”è¾ƒçŸ­ï¼Œåœ¨çˆ¶è¿›ç¨‹å›æ”¶å®ƒçš„èµ„æºåå°±ä¼šæ¶ˆäº¡ï¼›æˆ–è€…åœ¨çˆ¶è¿›ç¨‹é€€å‡ºåï¼Œç”± init è¿›ç¨‹å›æ”¶åä¹Ÿä¼šæ¶ˆäº¡]<br> <br></div>
                            <span class="time">2018-12-07 12:05</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ å¯ä»¥å†æ€è€ƒä¸€ç‚¹ï¼Œæ¯”å¦‚å‡å¦‚çˆ¶è¿›ç¨‹å·²ç»æ˜¯initäº†åˆè¯¥æ€ä¹ˆåŠï¼Ÿæ³¨æ„initè¿›ç¨‹æ˜¯ä¸ä¼šé€€å‡ºçš„</p>
                                <p class="reply-time">2018-12-09 08:13</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/11/c9/c3eae895.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¿ç»´å°å¸æœº</span>
                            </div>
                            <div class="bd">åé¢é‚£ä¸¤ä¸ªé•œåƒï¼Œæˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ç³»ç»Ÿçš„é—®é¢˜ï¼Œæˆ‘è¿è¡Œiowaitç›´æ¥é£šæ»¡äº†ï¼Œç³»ç»Ÿç›´æ¥å¡æ­»ã€‚ <br></div>
                            <span class="time">2018-12-07 10:25</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ninuxer</span>
                            </div>
                            <div class="bd">æ‰“å¡day9<br>åœ¨ç”¨perfå±•å¼€çš„åˆ†æè¯¦æƒ…ä¸­ï¼Œæœ‰ä¸ªchildrenå’Œselféƒ½90%å¤šçš„swapperè¿›ç¨‹ï¼Œå¦‚æœæˆ‘çœ‹åˆ°è¿™ä¸ªï¼Œæˆ‘è‚¯å®šä¼šå…ˆå»å›´ç»•è¿™ä¸ªè¿›ç¨‹å±•å¼€ï¼Œè€Œä¼šå¿½ç•¥å ç”¨æ‰0.6%å¾—appè¿›ç¨‹ï¼Œå…³äºè¿™ä¸ªæƒ…å†µï¼Œæ˜¯æˆ‘ç†è§£ä¸Šæœ‰ä»€ä¹ˆåå·®ä¹ˆï¼Ÿ <br></div>
                            <span class="time">2018-12-07 08:24</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å‘æ¡æ©™å­ ã€‚</span>
                            </div>
                            <div class="bd">è€å¸ˆ ï¼Œ æˆ‘è¿™è¾¹ä½¿ç”¨ stress æ¥æ¨¡æ‹Ÿ io çš„è¯·æ±‚ ï¼Œ å‘ç° stress çš„è¿›ç¨‹æ—¶è€Œ D æ—¶è€Œ R ã€‚ ä½†æ˜¯ç”¨ pidstat ã€ iostat  ä»¥åŠ dstat éƒ½æ²¡æœ‰çœ‹åˆ°å¯¹ ç£ç›˜æœ‰  è¯»æ•°æ®è¯·æ±‚ å’Œ å†™æ•°æ®è¯·æ±‚ ã€‚ æ‰€ä»¥è¿™ä¸ªæ˜¯ stress å·¥å…·æœ¬èº«çš„é—®é¢˜ä¹ˆ ï¼Ÿï¼Ÿ <br></div>
                            <span class="time">2018-12-16 16:30</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯èƒ½è·Ÿstressçš„é€‰é¡¹æœ‰å…³ï¼Œä½ çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ</p>
                                <p class="reply-time">2018-12-17 07:39</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/61/bc/88a905a5.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">èµµå¼ºå¼º</span>
                            </div>
                            <div class="bd">å€ªè€å¸ˆ.å…¬å¸ä¸€ä¸ªæœåŠ¡è°ƒç”¨é‡å¾ˆå¤§ï¼Œtopå‘½ä»¤è¾“å‡ºæ˜¾ç¤ºphp-fpm workerè¿›ç¨‹cpuä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä½†æ˜¯pidstatè¾“å‡ºç¡®æ‰¾ä¸åˆ°è¯¥è¿›ç¨‹ï¼Œè¿›ç¨‹ç¡®å®ä¸€ç›´å­˜åœ¨çš„ï¼Œæ˜¯ä»€ä¹ˆåŸå› å‘¢ <br></div>
                            <span class="time">2018-12-08 20:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¯•è¯•åˆ†æä¸‹çº¿ç¨‹</p>
                                <p class="reply-time">2018-12-09 07:33</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è·¯è¿‡</span>
                            </div>
                            <div class="bd">å¬è¯¾ç¨‹ï¼Œè¿˜ä¼šéœ€è¦æœ‰ç‚¹ç¼–ç¨‹çš„åŠŸåº•ï¼Œå¦åˆ™è¿™ä¸ªé—®é¢˜æ’æŸ¥èµ·æ¥åªèƒ½ç²—æš´ç®€å•å¤„ç†äº†ã€‚æŠŠé”…ä¸¢ç»™å¼€å‘äº†ã€‚:) <br></div>
                            <span class="time">2018-12-07 14:53</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ äº†è§£ä¸€äº›ç¼–ç¨‹çš„åŸºæœ¬åŠŸå¾ˆæœ‰å¸®åŠ©ï¼Œç‰¹åˆ«æ˜¯å¤æ‚é—®é¢˜çš„æœ€åå¾ˆå¯èƒ½è¦å»åˆ†æå‡½æ•°è°ƒç”¨æ ˆç­‰ï¼Œæ›´éœ€è¦ä¸€å®šçš„ç¼–ç¨‹åŠŸåº•ã€‚</p>
                                <p class="reply-time">2018-12-07 22:41</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e8/45/c58cb283.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¸†å¸†å¸†å¸†å¸†å¸†å¸†å¸†</span>
                            </div>
                            <div class="bd">@jeffï¼Œæ•°æ®åº“ä¸€èˆ¬éƒ½æœ‰è‡ªå·±çš„æ•°æ®ç¼“å†²æ± bufferpoolï¼Œåœ¨åˆé€‚çš„æ—¶é—´ï¼Œæ•°æ®åº“ä¼šä»ç£ç›˜è¯»å…¥æ•°æ®åˆ°bufferpoolï¼Œæˆ–è€…ä»bufferpoolå†™å‡ºæ•°æ®åˆ°ç£ç›˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œåè€Œä¸ä¼šæœ‰æ€§èƒ½çš„æå‡ï¼Œè€Œä¸”æ•°æ®åº“å†™å‡ºæ•°æ®åˆ°ç£ç›˜çš„æ—¶å€™ï¼Œå¿…é¡»å†™åˆ°äº†ç£ç›˜æ‰ç®—çœŸçš„å®Œæˆäº†æ•°æ®çš„æŒä¹…åŒ–ã€‚ <br></div>
                            <span class="time">2018-12-07 13:59</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ï¼Œè°¢è°¢åˆ†äº«</p>
                                <p class="reply-time">2018-12-09 07:50</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRCxev73gpRIKKwjvuU2WgFKcZ1rKrGhDSZpUMzRsEgvAEZN00XscsTXp0ib1OrNkn9LgH2hYxX1w/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">hsggj</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œperfé™¤äº†å¯ä»¥æ£€æµ‹C++ä¹‹å¤–ï¼Œå…¶ä»–çš„ä»£ç å¦‚java,phpçš„é—®é¢˜å¯ä»¥æ£€æµ‹å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-07 11:30</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯ä»¥çš„ï¼Œæˆ‘ä»¬æ¡ˆä¾‹é‡Œé¢å·²ç»æœ‰ä¸€ä¸ªPHPçš„ç¤ºä¾‹ï¼Œæˆ‘è¿˜ä¼šåœ¨ç­”ç–‘ä¸­ä»‹ç»Javaçš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
                                <p class="reply-time">2018-12-09 07:59</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è·¯è¿‡</span>
                            </div>
                            <div class="bd">ç”¨ubuntu åšå®éªŒå¾ˆé¡ºåˆ©ã€‚è¯·é—®è€å¸ˆï¼Œæ›¾ç»å‘ç”Ÿåƒµå°¸è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯1ï¼ŒæœåŠ¡å™¨åˆä¸æ–¹ä¾¿é‡å¯ï¼Œå¦‚ä½•æ¸…ç†è¿™æ ·çš„åƒµå°¸è¿›ç¨‹ï¼Ÿè°¢è°¢è€å¸ˆï¼ <br></div>
                            <span class="time">2018-12-07 08:28</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKibu8C3CeYGF6JCBribiaEPia5gibaQnj9icryPVwoF6ibosmdicXJIhBEUdn0aDwZQ32oTyJL86DgDswhAg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">èŠ±å¼€è¶è‡ªæ¥</span>
                            </div>
                            <div class="bd">æ‰¾åˆ°äº†åƒµæ­»è¿›ç¨‹ä¹‹åï¼Œå¦‚æœçˆ¶è¿›ç¨‹æ˜¯ç³»ç»Ÿçš„è¯ï¼Œæ€ä¹ˆåŠï¼Ÿé‡å¯ï¼Ÿé‡è£…ç³»ç»Ÿï¼Ÿ <br></div>
                            <span class="time">2018-12-29 14:16</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">çˆ¶è¿›ç¨‹æ˜¯å“ªä¸ªè¿›ç¨‹ï¼Ÿ</p>
                                <p class="reply-time">2018-12-29 17:27</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKibu8C3CeYGF6JCBribiaEPia5gibaQnj9icryPVwoF6ibosmdicXJIhBEUdn0aDwZQ32oTyJL86DgDswhAg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">èŠ±å¼€è¶è‡ªæ¥</span>
                            </div>
                            <div class="bd">æˆ‘å‘ç°æˆ‘å†™çš„ç¨‹åºä¸€ç›´æ˜¯ SçŠ¶æ€è¿›ç¨‹ã€‚è¿™ä¸ªæ˜¯ä¸æ˜¯å› ä¸ºæˆ‘çš„ä¸»çº¿ç¨‹ ä¸€ç›´åœ¨å¾ªç¯ç­‰å¾… å­çº¿ç¨‹å®Œæˆçš„åŸå› ï¼Ÿ<br>å®é™…ä¸Šæˆ‘ä»¬çœ‹åˆ°çš„è¿›ç¨‹çŠ¶æ€å°±æ˜¯ä¸»çº¿ç¨‹çš„çŠ¶æ€ï¼Ÿå­çº¿ç¨‹çš„çŠ¶æ€åº”è¯¥è¦ç”¨ top -Hp &lt;pid&gt; æ¥æ˜¾ç¤ºå§ <br></div>
                            <span class="time">2018-12-29 14:01</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ï¼Œæ˜¯çš„ã€‚åªè¦ä¸æ˜¯CPUå¯†é›†å‹åº”ç”¨ï¼Œå¾ˆå¤§æ¦‚ç‡çœ‹åˆ°çš„éƒ½æ˜¯SçŠ¶æ€</p>
                                <p class="reply-time">2018-12-29 17:28</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/4a/fb/70f14340.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">maoxiajun</span>
                            </div>
                            <div class="bd">lesson8æ‰“å¡ <br></div>
                            <span class="time">2018-12-26 13:28</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘</p>
                                <p class="reply-time">2018-12-26 22:38</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/d8/ee/6e7c2264.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Only now</span>
                            </div>
                            <div class="bd">Mark <br></div>
                            <span class="time">2018-12-24 20:02</span>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>