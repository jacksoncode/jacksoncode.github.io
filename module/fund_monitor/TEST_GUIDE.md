# 全球指数基金监控系统 - 测试指南

## 🎯 测试配置已完成

### 📊 监控基金组合 (全球指数主题)

已配置的10只指数基金，覆盖主要全球指数和投资主题：

| 基金代码 | 基金名称 | 指数主题 | 预警阈值 | 说明 |
|---------|---------|---------|----------|------|
| 513500 | 标普500ETF | 美股大盘 | 4.0% | 跟踪标普500指数 |
| 159941 | 纳指100ETF | 美股科技 | 5.0% | 跟踪纳斯达克100指数 |
| 512980 | 广发纳指100 | 美股科技 | 5.0% | 纳斯达克100指数基金 |
| 588000 | 科创50ETF | 中国科创 | 6.0% | 跟踪科创50指数 |
| 513030 | 华宝科创50ETF | 中国科创 | 6.0% | 科创50指数ETF |
| 515450 | 中证500增强ETF | 中盘成长 | 4.0% | 中证500指数增强 |
| 000311 | 景顺长城沪深300增强 | 大盘价值 | 4.0% | 沪深300指数增强 |
| 510500 | 中证500ETF | 中盘成长 | 4.0% | 跟踪中证500指数 |
| 515000 | 华夏中证红利ETF | 红利价值 | 3.0% | 跟踪红利指数 |
| 161130 | 易方达恒生ETF | 港股红利 | 4.0% | 港股红利股票 |

### 📧 邮件配置

- **发送邮箱**: firfunneral_h@126.com (163邮箱)
- **收件邮箱**: firfunneral_h@126.com
- **邮件主题**: 【全球指数基金监控】{date} 基金涨跌报告
- **邮件格式**: HTML格式，包含详细的基金数据表格

## 🚀 快速测试步骤

### 1. 设置邮箱授权码

**重要**: 需要先设置163邮箱的SMTP授权码才能发送邮件。

#### 获取163邮箱授权码步骤：
1. 登录163邮箱网页版
2. 进入"设置" → "POP3/SMTP/IMAP"
3. 开启SMTP服务
4. 获取授权码并保存

#### 更新配置文件：
```bash
# 编辑邮件配置文件
vim config/email_config.ini

# 找到 password 行，替换为你的授权码
password = your_actual_smtp_authorization_code
```

### 2. 运行测试

#### 配置验证测试
```bash
python3 validate_config.py
```

#### 数据获取测试
```bash
python3 test_funds.py
```

#### 邮件发送测试
```bash
python3 src/monitor_main.py --mode test
```

#### 完整监控测试
```bash
python3 src/monitor_main.py --mode once
```

### 3. 预期测试结果

#### ✅ 成功情况
- 能够获取部分基金的实时数据
- 数据处理和预警计算正常
- 生成HTML格式的邮件报告
- 成功发送邮件到 firfunneral_h@126.com

#### ⚠️ 可能的问题
- **网络问题**: 部分基金数据可能获取失败（正常情况）
- **授权码错误**: 邮件发送失败，检查163邮箱授权码
- **基金代码**: ETF代码可能需要根据实际情况调整

## 📈 监控报告示例

邮件报告将包含以下内容：

```
📊 全球指数基金监控日报 - 2024-08-30

📈 监控汇总
总监控基金数: 10
上涨基金数: 6
下跌基金数: 4
预警基金数: 2

📋 详细数据
┌─────────────────────┬────────┬─────────┬─────────┬─────────────┬────────┐
│ 基金名称           │ 净值   │ 涨跌幅  │ 涨跌额  │ 更新时间    │ 状态   │
├─────────────────────┼────────┼─────────┼─────────┼─────────────┼────────┤
│ 标普500ETF         │ 1.4567 │ +1.25%  │ +0.018  │ 15:00:00   │ 正常   │
│ 纳指100ETF         │ 2.1234 │ +2.35%  │ +0.048  │ 15:00:00   │ 正常   │
│ 科创50ETF          │ 0.8934 │ -1.85%  │ -0.017  │ 15:00:00   │ 正常   │
│ 华夏中证红利ETF    │ 1.1234 │ +5.20%  │ +0.056  │ 15:00:00   │ ⚠️预警 │
└─────────────────────┴────────┴─────────┴─────────┴─────────────┴────────┘

数据来源: 天天基金网、新浪财经等第三方平台 | 报告时间: 2024-08-30 15:30:10
```

## 🔧 故障排除

### 常见问题及解决方案

#### 1. 基金数据获取失败
```bash
# 检查网络连接
ping fund.eastmoney.com

# 测试单个基金
python3 -c "
import sys; sys.path.append('src')
from fund_crawler import FundCrawler
crawler = FundCrawler()
data = crawler.get_fund_data('513500')
print(data)
"
```

#### 2. 邮件发送失败
- 检查163邮箱是否开启SMTP服务
- 确认授权码是否正确配置
- 检查网络是否能访问163邮箱服务器

#### 3. 模块导入错误
```bash
# 检查Python路径
export PYTHONPATH=$PYTHONPATH:$(pwd)/src

# 重新运行测试
python3 validate_config.py
```

## 🕐 定时任务设置

### Linux/macOS 使用 crontab
```bash
# 编辑定时任务
crontab -e

# 添加每日监控（工作日9:30、11:30、15:00）
30 9,11,15 * * 1-5 cd /path/to/fund_monitor && python3 src/monitor_main.py --mode once
```

### Windows 使用任务计划程序
1. 打开"任务计划程序"
2. 创建基本任务 → 每天触发
3. 设置程序路径和参数

## 📞 技术支持

如遇问题可以：
1. 查看 `logs/monitor.log` 日志文件
2. 运行 `python3 validate_config.py` 诊断
3. 检查网络连接和邮箱配置
4. 通过网站联系表单反馈问题

---

**免责声明**: 指数基金投资有风险，投资需谨慎。本系统仅提供数据监控服务，不构成投资建议。请根据自身风险承受能力做出投资决策。